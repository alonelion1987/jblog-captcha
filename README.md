## Компонент для WordPress, генерирующий символьную «капчу»

**Версия: 1.4.3**

**Тест на версии WordPress 4.4.1** 

Модуль генерирует специальный символьно-числовой код, спроектирован преимущественно для использования в пользовательских формах и выводится простым шорткодом. Модуль автоматически подключается ко входу в админ-панель.

Шорткод выводит картинку с кодом и текстовое поле. Можно выбрать фон для изображения, изменить цвет шрифта и количество выводимых символов

### Установка

0. Скачать архив и поместить в директорию плагинов или найти в репозитории плагинов WordPress: "**JBlog Captcha**"
1. Активировать плагин через меню "Плагины" в WordPress
2. Перейти на страницу настроек "settings/JBlog Captcha" и изменить настройки по умолчанию

### Примеры использования на официальном сайте

Примеры использования доступны на официальном сайте:
[Оф. страница](http://jblog-project.ru/kapcha-v-polzovatelskix-formax/) |
[Пример использования плагина при создании AJAX формы обратной связи](http://jblog-project.ru/sozdaem-ajax-kontakt-formu-v-wordpress/)

### Примеры использования

Вывод в файлах-шаблонах темы: `do_shortcode("[jbcptch]")`, желательно с проверкой: `(class_exists('JBlogCaptcha')) ? do_shortcode("[jbcptch]") : ''`

В визуальном редакторе WordPress: [jbcptch]

Шорткод выведет вот такую картинку и поле ввода:

![Капча](http://jblog-project.ru/wp-content/uploads/2016/02/captcha_example.png)

Атрибут **name** текстового поля **str** (возможно, будет необходим, если вы будете передавать данные AJAX, в примерах есть акцент на этот момент)

Проверка осуществляется следующими методами:

`$c = JBlogCaptcha::instance();`

`$c->chekSession();`

`if($c->getChek()){ /* капча введена верно */ }else{ /* капча введена неверно */ }`

`chekSession()` — данный метод запускает сессию и сверяет значение введенное пользователем в поле капчи с сохраненным значением в этой сессии. Исходя из результатов проверки устанавливает ключевую опцию в одно из двух состоянии ( true / false ), записывает это значение в БД. Если, по какой то причине не удалось прочитать переменную в сессии, то начиная с версии 1.4.2 плагина, реализована дополнительная возможность записи кода капчи в переменной-свойстве класса, что в свою очередь гарантирует успешное установление данного значения в любом случае!
`getChek()` — метод возвращает одно из двух возможных состоянии ( true / false ), которое установил предыдущий метод.

### История изменении:

1.0 - Начальная версия

1.1 - Оптимизирован код ядра, деактивированы неиспользуемые методы класса, добавлен алфавит. В настройках можно устанавливать количество символов в выводе капчи (3-5).

1.2.3 - Добавлены 2 режима вывода символов капчи: регистрозависимый и регистронезависимый.

1.3.1 - Оптимизирован код генерации капчи таким образом, что кэш браузера впредь не сможет повлиять на актуальный вывод изображения, соответствующий коду текущей сессии. Успешное тестирование в IE10. Теперь возможно выбирать между показами 2-3, 3-4, 4-5 символов. Устранены нечитаемые символы из кода генерации капчи.

1.4.1 - Автоматическое подключение капчи к стандартной форме входа в административную часть WordPress.

1.4.2 - Исправлена ошибка с возможностью подключения к админ-панели с первого раза.

1.4.3 - Удалена функция сглаживания расширения PHP GD, так как не во всех сборках определена.


